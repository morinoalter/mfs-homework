<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <style>

    </style>
</head>

<body onload="renewcar()">
    <h1>购物车</h1>
    <div class="cont">
        <div>商品1 <button onclick="add(1)">添加至购物车</button><button onclick="del(1)">从购物车中删除</button></div>
        <div>商品2 <button onclick="add(2)">添加至购物车</button><button onclick="del(2)">从购物车中删除</button></div>
        <div>商品3 <button onclick="add(3)">添加至购物车</button><button onclick="del(3)">从购物车中删除</button></div>
        <div>商品4 <button onclick="add(4)">添加至购物车</button><button onclick="del(4)">从购物车中删除</button></div>
        <div>商品5 <button onclick="add(5)">添加至购物车</button><button onclick="del(5)">从购物车中删除</button></div>
        <div>商品6 <button onclick="add(6)">添加至购物车</button><button onclick="del(6)">从购物车中删除</button></div>
    </div>

    <h1>购物车内容</h1>
    <div id="box" class="cont">


    </div>


    <script>
        function add(index) {
            let val = localStorage.getItem(index);
            if (val == null) {
                localStorage.setItem(index, 1);
            } else {
                localStorage[index]++;
            }

            renewcar();
        }

        function del(index) {
            let val = localStorage.getItem(index);
            if (val == null || val == 0) {
                alert("商品数量不能是负数！");
            } else {
                localStorage[index]--;
            }
            renewcar();
        }

        function renewcar() {
            console.log("renew了哦");

            var box = document.getElementById("box");
            //清空子节点
            var chil = box.childNodes;
            for (let i = chil.length - 1; i >= 0; i--) {
                box.removeChild(chil[i]);
            }
            console.log(chil);


            //遍历localStorage键值对
            for (let i = 0; i < localStorage.length; i++) {
                let key = localStorage.key(i);
                let v = localStorage[key];
                if (v != 0) {
                    let node = document.createElement("DIV");
                    node.innerHTML = "商品" + key + "   数量：" + v;
                    box.appendChild(node);
                }

            }


        }
    </script>

</body>

</html>